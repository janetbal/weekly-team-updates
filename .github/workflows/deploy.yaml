name: Deploy to Quick

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy-markets:
    runs-on: ubuntu-latest
    name: Deploy Markets Weekly Updates

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Deploy to Quick
        run: |
          curl -X POST "${{ secrets.QUICK_DEPLOY_URL }}" \
            -H "Content-Type: application/json" \
            -H "Authorization: Bearer ${{ secrets.QUICK_DEPLOY_TOKEN }}" \
            -d '{
              "site": "markets-weekly-updates",
              "source": "github",
              "repo": "${{ github.repository }}",
              "ref": "${{ github.sha }}",
              "path": "markets"
            }'

      - name: Verify deployment
        run: |
          echo "Deployed to https://markets-weekly-updates.quick.shopify.io"
          echo "Commit: ${{ github.sha }}"

  # Uncomment to add Channels team deployment
  # deploy-channels:
  #   runs-on: ubuntu-latest
  #   name: Deploy Channels Weekly Updates
  #
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4
  #
  #     - name: Deploy to Quick
  #       run: |
  #         curl -X POST "${{ secrets.QUICK_DEPLOY_URL }}" \
  #           -H "Content-Type: application/json" \
  #           -H "Authorization: Bearer ${{ secrets.QUICK_DEPLOY_TOKEN }}" \
  #           -d '{
  #             "site": "channels-weekly-updates",
  #             "source": "github",
  #             "repo": "${{ github.repository }}",
  #             "ref": "${{ github.sha }}",
  #             "path": "channels"
  #           }'
